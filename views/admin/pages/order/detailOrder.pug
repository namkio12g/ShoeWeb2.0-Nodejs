extends ../../layout/default.pug
include ../../mixins/order_infor.pug
include ../../mixins/pagination.pug
include ../../mixins/detailProduct.pug
include ../../mixins/confirm.pug

block main
    .container-fluid
    section.mg-5.pd-none.bg.wrapper-order-detail
        .row.bg
            .col-11.titel-order-detail
                    h2 hóa đơn ##{order._id}
            .col-1.titel-order-detail 
                a.fs-3(href="/admin/orders/")
                    i.fa-solid.fa-backward 
        .row
            .col-12
                .modal-header
                    h4#exampleModalLabel.modal-title Order Information : 
                .modal-body
                    .row.row-detail-order
                        .col-4.infor-item-order
                                lable ID hóa đơn:  
                                span.fs-4.infor-item ##{order._id}

                        .col-4.infor-item-order
                                lable Tên khách hàng: 
                                span.fs-4.infor-item #{order.nameCustomer}
                        .col-4.infor-item-order
                                lable Phương thức thanh toán: 
                                span.fs-4.infor-item #{order.payMethod}
                    .row.row-detail-order
                        .col-4.infor-item-order
                                lable Tổng tiền toàn bộ sản phẩm:  
                                span.fs-4.infor-item #{order.priceTotal}VND

                        .col-4.infor-item-order
                                lable Tổng số lượng sản phẩm: 
                                span.fs-4.infor-item #{order.quantityTotal}
                        .col-4.infor-item-order
                                lable Tổng tiền áp dụng mã giảm giá : 
                                span.fs-4.infor-item #{order.coupponTotal}VND
                    .row.row-detail-order
                        .col-4.infor-item-order
                                lable Tổng tiền sau khi áp mẫ : 
                                span.fs-4.infor-item #{order.priceTotal-order.coupponTotal}VND
                        .col-4.infor-item-order
                                lable Số điện thoại: 
                                span.fs-4.infor-item #{order.phoneNumber}
                        .col-4.infor-item-order
                                lable Trạng thái: 
                                span.fs-5.px-3.py-2( style=`color:white;background-color:${order.status===1?"#05BC04":order.status===2?"#40D6DE":order.status===4?"#D7152C":order.status===3?"#6E09BC":"#92B8C1"};border-radius:20px`) #{order.status===1?"Chưa xác nhận":order.status===2?"Đã xác nhận":order.status===4?"Giao hàng thành công":order.status===3?"Đang giao hàng":"Đã hủy"}                   
                    .row.row-detail-order
                        .col-4.infor-item-order
                                lable Ngày lập đơn:  
                                span.fs-4.infor-item.infor-item-date #{order.formattedDate}
                        .col-4.infor-item-order
                                lable Địa chỉ:  
                                span.fs-4.infor-item #{order.address}
                        .col-4.infor-item-order
                                lable EditBy/EditedAt :
                                if(order.staffName)  
                                    span.fs-4.infor-item #{order.staffName}/#{order.formattedDateEdit}
                        
        .row
            .col-12
                .modal-header
                    h4#exampleModalLabel.modal-title Products : 
                .modal-body
                    .row.row-detail-order
                        table.table.align-middle.tableProduct
                            thead
                                tr
                                    th(scope='col',style='width: 5%' first) STT
                                    th(scope='col',style='width: 10%') Product ID
                                    th(scope='col',style='width: 10%') Product Name
                                    th(scope='col',style='width: 10%') image
                                    th(scope='col',style='width: 10%') Size
                                    th(scope='col',style='width: 10%') quantity
                                    th(scope='col',style='width: 10%') Tổng Tiền
                            tbody.table-group-divider
                                each item,index in order.productArray
                                    +order_infor_detail_item(item,index)
                                tr.text-start.tr-content
                                                th(class="stt_tableProduct",scope='row' first) Total
                                                td(class="_tableProduct")
                                                td(class="_tableProduct")
                                                td.img_tableProduct
                                                td(class="_tableProduct")
                                                td(class="_tableProduct") #{order.quantityTotal}
                                                td(class="_tableProduct") #{order.priceTotal}
                    .row.row-detail-order
                        .col-5.infor-item-order
                                lable Phương thức thanh toán:  
                                span.infor-item #{order.payMethod}
                    .row.row-detail-order
                        .col-5.infor-item-order
                                lable Tổng số tiền ban đầu:  
                                span.infor-item #{order.priceTotal} VND
                    .row.row-detail-order
                        .col-5.infor-item-order
                                lable Tổng số tiền sau khi áp mãz   :  
                                span.infor-item #{order.priceTotal-order.coupponTotal}VND
        .row.row-detail-order
            .col-5.infor-item-order
                if order.status==="Chưa Xác Nhận"
                    button.btn.btn-danger.btn-cancel(id_order=order._id type='button' data-toggle="modal" data-target="#exampleModal" btn_delete_order ) Hủy
                    button.btn.btn-success.ml-1.openConfirm(type='button') Xác Nhận
        +confirm("Bạn Có Muốn Hủy Không")
    form(
    action="",
    method="POST",
    id = "form_delete_order",
    data_path_delete =`/admin/orders/delete`
    )

    script(src="/build/order.bundle.js")
